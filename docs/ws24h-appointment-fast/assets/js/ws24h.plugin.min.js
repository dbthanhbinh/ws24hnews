$(document).ready((function(){var e="";function t(e,t){var a=!1;return!function(e){return!e||e.length<1}(e)?(document.getElementById(t).classList.remove("error"),document.getElementById(t+"_required").classList.remove("error")):(document.getElementById(t).classList.add("error"),document.getElementById(t+"_required").classList.add("error"),a=!0),a}function a(e,t){var a=new Date(e);return a.setDate(e.getDate()+t),a}function n(t){var a=$("#demo1-1").find("tr.entryBlock");(e=e.toString())===t&&a&&a.length>0?(a.remove(),e=""):(a&&a.length>0&&(a.remove(),e=""),function(e=""){$.ajax({type:"post",dataType:"json",url:adminAjax,data:{action:"loadtimeset",setDate:e},context:this,beforeSend:function(){},success:function(t){if(t.success){var a=t&&t.data?t.data:[],n="";a?.length>0&&(n+="<table><body>",a.forEach((t=>{var a="available",o=!0,r='<i class="fa fa-check" aria-hidden="true"></i>';t.available||(o=!1,r='<i class="fa fa-times" aria-hidden="true"></i>',a="not-available"),n+='<tr><td class="time-entry '+a+'">',n+='<span data-available="'+o+'" data-setdate="'+e+'" data-timesetlabel="'+t.range_name+'" data-value="'+t.id+'" class="time-entry-block"><i class="fa fa-clock-o" aria-hidden="true"></i> '+t.range_name+"&nbsp;&nbsp;|&nbsp;&nbsp;"+r+"</span>",n+="</td></tr>"})),n+="</body></table>"),$("#demo1-1").find("td.selected").parents("tr").after('<tr class="entryBlock"><td colspan="7"> '+n+" </td></tr>")}else alert("Đã có lỗi xảy ra")},error:function(e,t,a){console.log("The following error occured: "+t,a)}})}(e=t))}function o(e,t){$("<div class='log__entry'/>").hide().html("<strong>"+e+"</strong>: "+t).prependTo($("#eventlog")).show(200)}$("#clearlog").click((function(){$("#eventlog").html("")}));var r=new Date,s=r.getHours()>12?a(r,0):r;$("#demo1-1").datetimepicker({date:s,startDate:s,endDate:a(r,30),viewMode:"YMDHMS",onDateChange:function(){n(this.getText("YYYY-MM-DD"))},onClear:function(){o("onClear",this.getValue())},onOk:function(){o("onOk",this.getValue())},onClose:function(){o("onClose",this.getValue())}}),$("#demo1-1").on("click",".time-entry-block",(function(){document.getElementById("ap_setdate").value=$(this).attr("data-setdate"),document.getElementById("ap_timeset").value=$(this).attr("data-value");var e="&nbsp;"+$(this).attr("data-setdate")+"&nbsp; &nbsp;|&nbsp;&nbsp;"+$(this).attr("data-timesetlabel");(document.getElementById("ap_timeset_label").innerHTML=e,"true"===$(this).attr("data-available"))&&document.getElementById("btn-primary-appointment").click()})),$(".js-btn-book-appointment").on("click",(function(){var e=document.getElementById("ap_setdate").value,a=document.getElementById("ap_timeset").value,n=document.getElementById("ap_name").value,o=document.getElementById("ap_phone").value,r=document.getElementById("ap_message").value,s=document.getElementById("ap_service").value,l=0;return t(n,"ap_name")&&l++,t(o,"ap_phone")&&l++,t(r,"ap_message")&&l++,function(e,t){var a=!1;return function(e){return!e||e<1}(e)?(document.getElementById(t).classList.add("error"),document.getElementById(t+"_required").classList.add("error"),a=!0):(document.getElementById(t).classList.remove("error"),document.getElementById(t+"_required").classList.remove("error")),a}(parseInt(s),"ap_service")&&l++,l>0||function(e){$.ajax({type:"post",dataType:"json",url:adminAjax,data:{action:e.action,fullName:e.fullName,phone:e.phone,customNote:e.customNote,setDate:e.setDate,timeSetId:e.timeSetId,serviceId:e.serviceId,coupon:e.coupon},context:this,beforeSend:function(){$(".modal-spinner-mark").removeClass("close"),$(".modal-spinner-mark").addClass("open"),$(".appointment-form-error").html("Xử lý ..."),$(".appointment-form-error").removeClass("close"),$(".appointment-form-error").addClass("open")},success:function(e){console.log("=====: ",e),e.success?($(".modal-spinner-mark").removeClass("open"),$(".modal-spinner-mark").addClass("close"),e.data?.error?$(".appointment-form-error").html(e.data.errorMsg):$(".appointment-form-error").html("Thành công ...")):($(".modal-spinner-mark").removeClass("open"),$(".modal-spinner-mark").addClass("close"))},error:function(e,t,a){console.log("The following error occured: "+t,a)}})}({action:"addappointment",fullName:n,phone:o,customNote:r,setDate:e,timeSetId:a,serviceId:s,coupon:""}),!1}))}));